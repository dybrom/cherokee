!function(){var e=angular.module("timeKeeper",["ngRoute","ui.bootstrap"]);e.constant("timeConfig",{apiUrl:"http://localhost:56111/api/",idsUrl:"http://localhost:9002/connect/token",dayType:["empty","workingday","publicholiday","otherabsence","religiousday","sickleave","vacation","businessabsence","weekend","future"],dayDesc:[" ","Working Day","Public Holiday","Other Absence","Religious Day","Sick Leave","Vacation","Business Absence"],months:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],years:["2016","2017","2018"]}),e.config(["$routeProvider",function(e){e.when("/dashboard",{templateUrl:"views/dashboard.html",controller:"timeTrackingController"}).when("/teams",{templateUrl:"views/teams.html",controller:"teamsController"}).when("/employees",{templateUrl:"views/employees.html",controller:"employeesController"}).when("/customers",{templateUrl:"views/customers.html",controller:"customersController"}).when("/projects",{templateUrl:"views/projects.html",controller:"projectsController"}).when("/calendar",{templateUrl:"views/timeTracking.html",controller:"timeTrackingController"}).when("/invoices",{templateUrl:"views/invoices.html",controller:"timeTrackingController"}).otherwise({redirectTo:"/dashboard"})}])}(),function(){var e=angular.module("timeKeeper");e.controller("customersController",["$scope","dataService",function(e,o){e.message="Wait...",o.list("customers",function(o){e.message="",e.customers=o})}]),e.controller("custController",["$scope","$uibModal","dataService",function(e,o,t){e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModal.html",controller:"custModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})},e.save=function(){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModal.html",controller:"custModalCtrl",controllerAs:"$cust",resolve:{customer:function(){}}})},e.delete=function(e){void 0!=e.id&&t.delete("customers",e.id,function(e){window.alert("Customer deleted!")})}}]),e.controller("custModalCtrl",["$uibModalInstance","$scope","customer","dataService",function(e,o,t,n){console.log(t),o.customer=t,o.oldcustomer=angular.copy(t),o.save=function(e){console.log(e),void 0===e.id?n.insert("customers",e,function(e){window.alert("customer inserted!")}):n.update("customers",e.id,e,function(e){window.alert("customer updated!")})},o.cancel=function(){angular.copy(o.oldcustomer,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("employeesController",["$scope","$uibModal","dataService",function(e,o,t){e.showPagination=!0,e.currentPage=0,t.list("employees",function(o,t){e.page=JSON.parse(t("pagination")),e.message="",e.people=o,e.totalItems=e.page.TotalItems}),e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaLabelledBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){return e}}})},e.filter=function(o){""!=o?t.list("employees?pageSize=50&filter="+o,function(o,t){e.people=o,e.showPagination=!1}):""==o&&t.list("employees",function(o,t){e.people=o,e.showPagination=!0})},e.add=function(){o.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaLabelledBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){}}})},e.delete=function(e){1==window.confirm("Press a button")&&t.delete("employees",e.id,function(e){window.alert("Successfully deleted!")})},e.pageChanged=function(){var o=e.currentPage-1;t.list("employees?page="+o,function(o,t){e.people=o}),console.log("Page changed to: "+e.currentPage)}}]),e.controller("EmpModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,n){n.list("roles",function(e){o.roles=e}),console.log(t),o.person=t,o.oldPerson=angular.copy(t),o.ok=function(o){void 0==o.id?n.insert("employees",o,function(){window.alert("Employee successfully inserted!"),e.close()}):n.update("employees",o.id,o,function(o){window.alert("Employee successfully updated!"),e.close()})},o.cancel=function(t){angular.copy(o.oldPerson,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectsController",["$scope","dataService",function(e,o){e.message="Wait...",o.list("projects",function(o){e.message="",e.projects=o})}]),e.controller("projController",["$scope","$uibModal","dataService",function(e,o,t){e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.save=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){}}})},e.add=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModalAdd.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.delete=function(e){void 0!=e.id&&t.delete("projects",e.id,function(e){window.alert("Project deleted!")})}}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","project","dataService",function(e,o,t,n){n.list("customers",function(e){o.customers=e}),n.list("teams",function(e){o.teams=e}),console.log(t),o.project=t,o.oldproject=angular.copy(t),o.save=function(e){console.log(e),void 0===e.id?n.insert("projects",e,function(e){window.alert("Project inserted!")}):n.update("projects",e.id,e,function(e){window.alert("Project updated!")})},o.cancel=function(){angular.copy(o.oldproject,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamsController",["$scope","$uibModal","dataService",function(e,o,t){e.message="Wait...",t.list("teams",function(o){e.message="",e.teams=o});e.add=function(){o.open({animation:!0,ariaLabelledBy:"tm-new-modal-title",ariaDescribedBy:"tm-new-modal-body",templateUrl:"views/modals/tmNewTeamModal.html",controller:"TmNewTeamModalCtrl",controllerAs:"$tm",resolve:{team:function(){}}})}}]),e.controller("TmNewTeamModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,n){console.log(t),o.team=t,o.oldteam=angular.copy(t),o.add=function(o){n.insert("teams",o,function(o){e.close()&&window.alert("Team added!")})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}]),e.controller("tmController",["$scope","$uibModal","dataService",function(e,o,t){e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/tmModal.html",controller:"TmModalCtrl",controllerAs:"$tm",resolve:{team:function(){return e}}})},e.addMember=function(e){o.open({animation:!0,ariaLabelledBy:"tm-add-emp-modal-title",ariaDescribedBy:"tm-add-emp-modal-body",templateUrl:"views/modals/tmAddEmpModal.html",controller:"TmAddEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return e}}})},e.editMember=function(e){o.open({animation:!0,ariaLabelledBy:"tm-emp-modal-title",ariaDescribedBy:"tm-emp-modal-body",templateUrl:"views/modals/tmEmpModal.html",controller:"TmEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return e}}})},e.delete=function(e){t.delete("teams",e.id,function(e){window.alert("Deleted")})},e.deleteMember=function(e){t.delete("teams",e.member.id,function(e){window.alert("Deleted")})}}]),e.controller("TmModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,n){console.log(t),o.team=t,o.oldteam=angular.copy(t),o.ok=function(o){n.update("teams",o.id,o,function(o){e.close()})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}]),e.controller("TmEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,n){console.log(t),n.list("roles",function(e){o.roles=e}),o.member=t,o.oldMember=angular.copy(t),o.ok=function(o){n.update("members",o.id,o,function(o){e.close()})},o.cancel=function(t){angular.copy(o.oldMember,t),e.dismiss()}}]),e.controller("TmAddEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,n){console.log(t),o.member=t,o.oldteam=angular.copy(t),n.list("employees/all",function(e){o.employees=e}),o.add=function(o){n.insert("members",o,function(o){e.close()&&window.alert("Member added!")})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("timeTrackingController",["$scope","$uibModal","dataService","timeConfig",function(e,o,t,n){function l(o,n,l){var a="calendar?id="+o;"undefined"!=n&&(a+="&year="+n),"undefined"!=l&&(a+="&month="+l),t.list(a,function(o){e.calendar=o,e.empId=o.employee.id,e.year=o.year,e.month=o.month-1,e.num=function(){var e=new Date(o.days[0].date).getDay()-1;return e<0&&(e=6),new Array(e)}})}e.dayType=n.dayType,e.months=n.months,e.month=6,t.list("employees/all",function(o){e.people=o}),e.buildCalendar=function(){void 0===e.empId?window.alert("You have to choose an employee"):l(e.empId,e.year,e.month+1)},e.$on("calendarUpdated",function(o){l(e.empId,e.year,e.month+1)}),e.edit=function(e){o.open({animation:!0,templateUrl:"views/modals/calendarModal.html",controller:"ModalCalendarCtrl",size:"lg",resolve:{day:function(){return e}}})}}]),e.controller("ModalCalendarCtrl",["$uibModalInstance","$scope","dataService","timeConfig","day",function(e,o,t,n,l){function a(){o.day.hours=0;for(var e=0;e<o.day.details.length;e++)o.day.details[e].deleted||(o.day.hours+=Number(o.day.details[e].hours))}function r(){o.newTask={id:0,description:"",hours:0,project:{id:0,name:""},deleted:!1}}o.day=l,o.dayType=n.dayDesc,t.list("projects",function(e){o.projects=e,console.log(o.day)}),r(),o.add=function(e){o.day.details.push(e),a(),r()},o.upd=function(e,o){a()},o.del=function(e){o.day.details[e].deleted=!0,a()},o.ok=function(){t.insert("calendar",o.day,function(e){o.$emit("calendarUpdated")}),a(),e.close()},o.cancel=function(){e.dismiss()},o.typeChanged=function(){1!=o.day.type&&(o.day.hours=8)}}])}(),function(){angular.module("timeKeeper").directive("customer",[function(){return{restrict:"E",scope:{data:"="},controller:"custController as $cust",templateUrl:"views/widgets/customer-widget.html"}}])}(),function(){angular.module("timeKeeper").directive("employee",[function(){return{restrict:"E",scope:{people:"=employee"},controller:"empController as $emp",templateUrl:"views/employees.html"}}])}(),function(){angular.module("timeKeeper").directive("project",[function(){return{restrict:"E",scope:{data:"="},controller:"projController as $proj",templateUrl:"views/widgets/project-widget.html"}}])}(),function(){angular.module("timeKeeper").directive("team",[function(){return{restrict:"E",scope:{data:"=team"},controller:"tmController as $tm",templateUrl:"views/widgets/team-widget.html"}}])}(),function(){angular.module("timeKeeper").factory("dataService",["$http","timeConfig",function(e,o){var t=o.apiUrl;return{list:function(o,n){e.get(t+o).then(function(e){return n(e.data,e.headers)},function(e){window.alert(e.data.message)})},read:function(o,n,l){e.get(t+o+"/"+n).then(function(e){return l(e.data)},function(e){window.alert(e.data.message)})},insert:function(o,n,l){e({method:"post",url:t+o,data:n}).then(function(e){return l(e.data)},function(e){window.alert(e.data.message)})},update:function(o,n,l,a){e({method:"put",url:t+o+"/"+n,data:l}).then(function(e){return a(e.data)},function(e){window.alert(e.data.message)})},delete:function(o,n,l){e({method:"delete",url:t+o+"/"+n}).then(function(e){return l(e.data)},function(e){window.alert(e.data.message)})}}}])}();