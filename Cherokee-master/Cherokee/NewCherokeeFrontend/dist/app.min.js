!function(){var e=angular.module("timeKeeper",["ngRoute","ui.bootstrap","toaster","ngAnimate","naif.base64","chart.js"]);currentUser={id:0},projectId=0,teamId=0,customerId=0;e.constant("timeConfig",{apiUrl:"#"!=="#{ApiUrl}"[0]?"#{ApiUrl}":"http://localhost:56111/api/",idsUrl:"#"!=="#{AuthServer}"[0]?"#{AuthServer}/connect/token":"http://localhost:53834/connect/token",dayType:["empty","workingday","publicholiday","otherabsence","religiousday","sickleave","vacation","businessabsence","weekend","future"],dayDesc:[" ","Working Day","Public Holiday","Other Absence","Religious Day","Sick Leave","Vacation","Business Absence"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]}),e.config(["$routeProvider",function(e){e.when("/teams",{templateUrl:"views/teams.html",controller:"teamsController",loginR:!0}).when("/team",{templateUrl:"views/team.html",controller:"teamController",loginR:!0}).when("/profile",{templateUrl:"views/profile.html",controller:"profileController",loginR:!0}).when("/employees",{templateUrl:"views/employees.html",controller:"employeesController",loginR:!0}).when("/customers",{templateUrl:"views/customers.html",controller:"customersController",loginR:!0}).when("/customer",{templateUrl:"views/customer.html",controller:"customerController",loginR:!0}).when("/projects",{templateUrl:"views/projects.html",controller:"projectsController",loginR:!0}).when("/project",{templateUrl:"views/project.html",controller:"projectController",loginR:!0}).when("/calendar",{templateUrl:"views/timeTracking.html",controller:"timeTrackingController",loginR:!0}).when("/login",{templateUrl:"views/login.html",controller:"loginController",loginR:!1}).when("/logout",{templateUrl:"views/login.html",controller:"logoutController",loginR:!1}).when("/personalreport",{templateUrl:"views/personalReport.html",controller:"personalReportController",loginR:!0}).when("/annualreport",{templateUrl:"views/annualReport.html",controller:"annualReportController",loginR:!0}).when("/monthlyreport",{templateUrl:"views/monthlyReport.html",controller:"monthlyReportController",loginR:!0}).when("/projecthistory",{templateUrl:"views/projectHistory.html",controller:"projectHistoryController",loginR:!0}).when("/teamdashboard",{templateUrl:"views/teamDashboard.html",controller:"teamDashboardController",loginR:!0}).when("/companydashboard",{templateUrl:"views/companyDashboard.html",controller:"companyDashboardController",loginR:!0}).when("/missingentries",{templateUrl:"views/missingEntries.html",controller:"missingEntriesController",loginR:!0}).when("/charttest",{templateUrl:"views/chartTest.html",controller:"chartTestController",loginR:!0}).when("/billings",{templateUrl:"views/billings.html",controller:"billingsController",loginR:!0}).otherwise({redirectTo:"/personalreport"})}]).run(["$rootScope","$location",function(e,o){e.$on("$routeChangeStart",function(e,t,r){0===currentUser.id&&t.$$route.loginR&&o.path("/login")})}])}();var dropdown=document.getElementsByClassName("dropdown-btn"),i;for(i=0;i<dropdown.length;i++)dropdown[i].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"});$(window,document,void 0).ready(function(){$("input").blur(function(){var e=$(this);e.val()?e.addClass("used"):e.removeClass("used")});var e=$(".ripples");e.on("click.Ripples",function(e){var o=$(this),t=o.parent().offset(),r=o.find(".ripplesCircle"),n=e.pageX-t.left,a=e.pageY-t.top;r.css({top:a+"px",left:n+"px"}),o.addClass("is-active")}),e.on("animationend webkitAnimationEnd mozAnimationEnd oanimationend MSAnimationEnd",function(e){$(this).removeClass("is-active")})}),function(){var e=angular.module("timeKeeper");e.controller("annualReportController",["$scope","dataService","timeConfig","$location","$uibModal",function(e,o,t,r,n){function a(t){var r="reports/annual/";"undefined"!=t&&(r+=t),o.list(r,function(o){for(e.report=o,e.year=o.year,e.numOfProjects=o.list.length,e.numOfEmployees=0,e.totalHours=0,i=0;i<o.list.length-1;i++)e.numOfEmployees+=o.list[i].numOfEmployees,e.totalHours+=o.list[i].totalHours;for(e.dataForYearlyReportTotalHoursByProject=[],e.labelsForYearlyReportTotalHoursByProject=[],i=0;i<o.list.length-1;i++)e.labelsForYearlyReportTotalHoursByProject.push(o.list[i].projectName),e.dataForYearlyReportTotalHoursByProject.push(o.list[i].totalHours);for(e.OptionsForYearlyReportTotalHoursByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForNoOfEmployeesByProject=[],e.labelsForNoOfEmployeesByProject=[],i=0;i<o.list.length-1;i++)e.labelsForNoOfEmployeesByProject.push(o.list[i].projectName),e.dataForNoOfEmployeesByProject.push(o.list[i].numOfEmployees);e.OptionsForNoOfEmployeesByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.GetProjectChart=function(e,o,t){n.open({animation:!0,ariaLabelledBy:"annual-chart-modal-title",ariaDescribedBy:"annual-chart-modal-body",templateUrl:"views/modals/annualChartModal.html",controller:"annualChartModalCtrl",controllerAs:"$acm",resolve:{index:function(){return e},year:function(){return o},data:function(){return console.log(t),t}}})}})}e.year=2017,"Administrator"!=e.currentUser.role?r.path("/calendar"):(e.showing=!1,e.listReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):(a(e.year),e.showing=!0)},e.listReport())}]),e.controller("annualChartModalCtrl",["$scope","dataService","$uibModalInstance","index","year","data",function(e,o,t,r,n,a){for(e.index=r,console.log(e.index),e.year=n,console.log(e.year),e.name=a.projectName,e.totalHours=a.totalHours,e.CloseModal=function(){t.close()},e.dataForHoursByProjectAnnualModal=[],e.labelsForHoursByProjectAnnualModal=["January","February","March","April","May","June","July","August","September","October","November","December"],i=0;i<a.monthlyHours.length;i++)e.dataForHoursByProjectAnnualModal.push(a.monthlyHours[i]);e.OptionsForHoursByProjectAnnualModal={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}}])}(),function(){var e=angular.module("timeKeeper");e.controller("billingsController",["$scope","dataService","timeConfig","$uibModal",function(e,o,t,r){e.months=t.months,e.month=6,e.year=2017,e.showing=!1,"Administrator"!=e.currentUser.role?$location.path("/calendar"):e.billingReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):o.list("reports/InvoiceReport?year="+e.year+"&month="+(e.month+1),function(o){e.billings=o,e.showing=!0,e.year=o.year,e.month=o.month,console.log(e.billings),e.edit=function(e){r.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/invoiceModal.html",controller:"invoiceModalCtrl",controllerAs:"$bi",resolve:{invoice:function(){return e}}})}})}}]),e.controller("invoiceModalCtrl",["$uibModalInstance","$scope","invoice","dataService",function(e,o,t,r){o.invoice=t,console.log("unutar modala"+t),o.oldinvoice=angular.copy(t),o.cancel=function(o){e.dismiss()};o.DeleteInvoiceEntry=function(e){o.invoice.roles[e].status="Not included",console.log(o.invoice)},o.StagnateInvoice=function(){console.log(o.invoice),o.invoice.status="Canceled",r.insert("invoice",o.invoice,function(e){console.log("uspjesno stagniran")})},o.SendInvoice=function(){console.log(o.invoice);var e=0,t=0;angular.forEach(o.invoice.roles,function(o){"Included"==o.status&&e++,t++}),console.log(e+" "+t),0==e?o.invoice.status="Not sent":e>0&&e<t?o.invoice.status="Partially sent":e===t&&(o.invoice.status="Full bill sent"),r.insert("invoice",o.invoice,function(e){console.log("uspjesno")})}}])}(),function(){angular.module("timeKeeper").controller("chartTestController",["$scope",function(e){e.message="wow",e.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],e.data=[300,500,100]}])}(),function(){angular.module("timeKeeper").controller("companyDashboardController",["$scope","dataService","timeConfig",function(e,o,t){e.months=t.months,e.month=6,e.year=2017,e.showing=!1,"Administrator"!=e.currentUser.role?$location.path("/calendar"):(e.companyReport=function(){if(void 0==e.year)e.showing=!1,window.alert("Choose year!");else if(void 0==e.month)e.showing=!1,window.alert("Choose month!");else{var t=e.month+1;o.list("reports/CompanyReport?year="+e.year+"&month="+t,function(o){for(e.report=o,e.showing=!0,e.year=o.year,e.month=o.month-1,console.log(e.report),e.dataForUtilizationForCompany=[],e.labelsForUtilizationForCompany=["Total hours in this month","Total hours possible"],e.dataForUtilizationForCompany.push(o.totalHours),e.dataForUtilizationForCompany.push(o.maxPossibleHours),e.OptionsForUtilizationForCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationForCompanyByRole=[],e.labelsForUtilizationForCompanyByRole=["Developer","QA Engineer","UI/UX","Project Manager"],e.dataForUtilizationForCompanyByRole.push(o.devUtilization),e.dataForUtilizationForCompanyByRole.push(o.qaUtilization),e.dataForUtilizationForCompanyByRole.push(o.uiuxUtilization),e.dataForUtilizationForCompanyByRole.push(o.pmUtilization),e.OptionsForUtilizationForCompanyByRole={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationForCompanyByTeam=[],e.labelsForUtilizationForCompanyByTeam=[],i=0;i<o.teams.length;i++)e.labelsForUtilizationForCompanyByTeam.push(o.teams[i].name),e.dataForUtilizationForCompanyByTeam.push(o.teams[i].utilization);for(e.OptionsForUtilizationForCompanyByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForMissingEntriesInCompany=[],e.labelsForMissingEntriesInCompany=[],i=0;i<o.teams.length;i++)e.labelsForMissingEntriesInCompany.push(o.teams[i].name),e.dataForMissingEntriesInCompany.push(o.teams[i].missingEntries);for(e.OptionsForMissingEntriesInCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForOvertimeHoursByTeam=[],e.labelsForOvertimeHoursByTeam=[],i=0;i<o.teams.length;i++)e.labelsForOvertimeHoursByTeam.push(o.teams[i].name),e.dataForOvertimeHoursByTeam.push(o.teams[i].overtimeHours);for(e.OptionsForOvertimeHoursByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForRevenueByProject=[],e.labelsForRevenueByProject=[],i=0;i<o.projects.length;i++)e.labelsForRevenueByProject.push(o.projects[i].name),e.dataForRevenueByProject.push(o.projects[i].revenue);for(e.OptionsForRevenueByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForTotalHoursByTeam=[],e.labelsForTotalHoursByTeam=[],i=0;i<o.teams.length;i++)e.labelsForTotalHoursByTeam.push(o.teams[i].name),e.dataForTotalHoursByTeam.push(o.teams[i].totalHours);for(e.OptionsForTotalHoursByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.labelsForRolesInCompany=["Project Manager","Developer","QA Engineer","UI/UX Designer"],e.dataForRolesInCompany=[o.pmCount,o.devCount,o.qaCount,o.uiuxCount],e.OptionsForRolesInCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForPTOByTeamCompany=[],e.labelsForPTOByTeamCompany=[],i=0;i<o.teams.length;i++)e.labelsForPTOByTeamCompany.push(o.teams[i].name),e.dataForPTOByTeamCompany.push(o.teams[i].pto);e.OptionsForPTOByTeamCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,ticks:{suggestedMin:0,autoSkip:!1,beginAtZero:!0}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}},e.companyReport())}])}(),function(){angular.module("timeKeeper").controller("customerController",["$scope","dataService","$location",function(e,o,t){"Administrator"!=e.currentUser.role||0==e.customerId?t.path("/calendar"):(console.log(e.customerId),o.read("customers",e.customerId,function(o){e.customer=o}))}])}(),function(){var e=angular.module("timeKeeper");e.controller("customersController",["$scope","$uibModal","$location","$rootScope","dataService",function(e,o,t,r,n){function a(){n.list("customers",function(o){e.customers=o})}"Administrator"!=e.currentUser.role?t.path("/calendar"):(a(),e.$on("customersUpdated",function(e){a()})),e.view=function(e){console.log(e),t.path("/customer"),r.customerId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModal.html",controller:"custModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})},e.add=function(){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModalAdd.html",controller:"custModalAddCtrl",controllerAs:"$cust",resolve:{customer:function(){}}})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this customer?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(n.delete("customers",o.id,function(o){e.$emit("customersUpdated")}),swal.close())})}}]),e.controller("custModalCtrl",["$uibModalInstance","$scope","customer","dataService",function(e,o,t,r){o.customer=t,o.oldcustomer=angular.copy(t),o.save=function(t){r.update("customers",t.id,t,function(t){window.alert("Customer updated!"),o.$emit("customersUpdated"),e.close()})},o.cancel=function(){angular.copy(o.oldcustomer,t),e.dismiss()}}]),e.controller("custModalAddCtrl",["$uibModalInstance","$scope","customer","dataService",function(e,o,t,r){o.customer=t,o.add=function(t){r.insert("customers",t,function(t){window.alert("Customer inserted!"),o.$emit("customersUpdated"),e.close()})},o.cancel=function(){angular.copy(o.oldcustomer,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("employeesController",["$scope","dataService","$location",function(e,o,t){"Administrator"!=e.currentUser.role?t.path("/calendar"):e.$on("employeesUpdated",function(){o.list("employees",function(o){e.people=o})})}]),e.controller("empController",["$scope","$rootScope","$uibModal","dataService","$location",function(e,o,t,r,n){e.showPagination=!0,e.currentPage=0,r.list("employees",function(o,t){e.page=JSON.parse(t("pagination")),console.log(e.page),e.people=o,e.totalItems=e.page.TotalItems}),e.view=function(e){n.path("/profile"),o.currentUser.profileId=e.id},e.edit=function(o){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){return o}}}).closed.then(function(){e.$emit("employeesUpdated")})},e.filter=function(o){""!=o?r.list("employees?pageSize=50&filter="+o,function(o,t){e.people=o,e.showPagination=!1}):""==o&&r.list("employees",function(o,t){e.people=o,e.showPagination=!0})},e.add=function(){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empAddModal.html",controller:"EmpAddModalCtrl",controllerAs:"$emp",resolve:{person:function(){}}}).closed.then(function(){e.$emit("employeesUpdated")})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this employee?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(r.delete("employees",o.id,function(o){window.alert("Employee deleted!"),e.$emit("employeesUpdated")}),swal.close())})},e.pageChanged=function(){var o=e.currentPage-1;r.list("employees?page="+o,function(o,t){e.people=o}),console.log("Page changed to: "+e.currentPage)}}]),e.controller("EmpModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,r){r.list("roles",function(e){o.roles=e}),o.person=t,o.oldPerson=angular.copy(t),o.save=function(t){t.image=o.person.image?o.person.image.base64:"",r.update("employees",t.id,t,function(e){o.$emit("employeesUpdated"),window.alert("Employee successfully updated!")}),e.close()},o.cancel=function(t){angular.copy(o.oldPerson,t),e.dismiss()}}]),e.controller("EmpAddModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,r){r.list("roles",function(e){o.roles=e}),o.person=t,o.add=function(t){t.image=o.person.image?o.person.image.base64:"",r.insert("employees",t,function(){o.$emit("employeesUpdated"),window.alert("Employee successfully inserted!")}),e.close()},o.cancel=function(){e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("loginController",["$scope","$rootScope","$http","timeConfig","$location","infoService",function(e,o,t,r,n,a){function s(e){auth2.attachClickHandler(e,{},function(e){var a=e.getAuthResponse().id_token;t.defaults.headers.common.Authorization="Bearer "+a,t.defaults.headers.common.Provider="google",t({method:"post",url:r.apiUrl+"login"}).then(function(e){currentUser=e.data,o.currentUser=currentUser,console.log(currentUser),n.path("/calendar")},function(e){window.alert(e.message)})})}o.currentUser=currentUser,function(e){gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:"326400772016-03r6f1vcglt2lqbegvhphv6hjtj31sfq.apps.googleusercontent.com"}),s(document.getElementById(e))})}("loginBtn"),e.login=function(){var s={grant_type:"password",username:e.user.name,password:e.user.pass,scope:"openid"},i={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic dGltZWtlZXBlcjokY2gwMGw="};t({method:"POST",url:r.idsUrl,headers:i,data:s,transformRequest:function(e){var o=[];for(var t in e)o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")}}).success(function(e,a,s,i){authToken=e.access_token,t.defaults.headers.common.Authorization="Bearer "+authToken,t.defaults.headers.common.Provider="iserver",t({method:"GET",url:r.apiUrl+"login"}).success(function(e,t,r,a){currentUser=e,currentUser.token=authToken,console.log(currentUser),o.currentUser=currentUser,n.path("/calendar")})}).error(function(e,o,t,r){document.getElementById("err").innerHTML="Invalid Username or Password!",a.warning("Login","Invalid Username or Password")})}}]),e.controller("logoutController",["$rootScope","$location",function(e,o){currentUser={id:0,role:"",name:"",teams:[],provider:"",token:""},e.currentUser=currentUser,window.location.reload(),o.path("/calendar"),console.log(currentUser)}])}(),function(){angular.module("timeKeeper").controller("missingEntriesController",["$scope","dataService","timeConfig",function(e,o,t){"Administrator"!=e.currentUser.role&&$location.path("/calendar"),e.months=t.months,e.year=2017,e.month=6,o.list("missingentries?year="+e.year+"&month="+e.month,function(o){e.entriesreport=o,e.year=o.year,e.month=o.month}),e.listReport=function(){o.list("missingentries?year="+e.year+"&month="+e.month,function(o){e.entriesreport=o,e.year=o.year,e.month=o.month})},e.deleteEntry=function(o){e.entriesreport.employees.splice(o,1),console.log(e.entriesreport)},e.SendEmails=function(){o.insert("missingentries",e.entriesreport,function(e){console.log("uspjesno")})}}])}(),function(){var e=angular.module("timeKeeper");e.controller("monthlyReportController",["$scope","dataService","timeConfig","$location","$uibModal",function(e,o,t,r,n){function a(t,r){var a="reports/monthly/";"undefined"!=t&&(a+=t),"undefined"!=r&&(a+="/"+r),o.list(a,function(o){for(e.report=o,e.year=o.year,e.month=o.month-1,e.dataForMonthlyReportTotalHoursByProject=[],e.labelsForMonthlyReportTotalHoursByProject=[],i=0;i<o.projects.length;i++)e.labelsForMonthlyReportTotalHoursByProject.push(o.projects[i].project),e.dataForMonthlyReportTotalHoursByProject.push(o.projects[i].hours);for(e.OptionsForMonthlyReportTotalHoursByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForNumberOfEmployeesByProject=[],e.labelsForNumberOfEmployeesByProject=[],i=0;i<o.projects.length;i++){var t=0;for(e.labelsForNumberOfEmployeesByProject.push(o.projects[i].project),j=0;j<o.items.length;j++)0!=o.items[j].hours[i]&&t++;e.dataForNumberOfEmployeesByProject.push(t)}e.OptionsForNumberOfEmployeesByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.MakeProjectChart=function(e,o){n.open({animation:!0,ariaLabelledBy:"monthlyProject-chart-modal-title",ariaDescribedBy:"monthlyProject-chart-modal-body",templateUrl:"views/modals/monthlyProjectModal.html",controller:"monthlyProjectChartModalCtrl",controllerAs:"$pcm",resolve:{index:function(){return e},report:function(){return console.log(o),o}}})},e.MakeEmployeeChart=function(e,o){n.open({animation:!0,ariaLabelledBy:"monthlyEmployee-chart-modal-title",ariaDescribedBy:"monthlyEmployee-chart-modal-body",templateUrl:"views/modals/monthlyEmployeeModal.html",controller:"monthlyEmployeeChartModalCtrl",controllerAs:"$acm",resolve:{index:function(){return e},report:function(){return o}}})}})}e.year=2017,e.month=7,"Administrator"!=e.currentUser.role?r.path("/calendar"):(e.months=t.months,e.showing=!1,e.listReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):(a(e.year,e.month+1),e.showing=!0)},e.listReport())}]),e.controller("monthlyProjectChartModalCtrl",["$scope","dataService","$uibModalInstance","index","report",function(e,o,t,r,n){for(e.index=r,console.log(e.index),e.year=n.year,console.log(e.year),console.log(n),e.name=n.projects[r].project,e.totalHours=n.projects[r].hours,e.CloseModal=function(){t.close()},e.dataForHoursByProjectMonthlyModal=[],e.labelsForHoursByProjectMonthlyModal=[],i=0;i<n.items.length;i++)n.items[i].hours[r]>0&&(e.labelsForHoursByProjectMonthlyModal.push(n.items[i].employee),e.dataForHoursByProjectMonthlyModal.push(n.items[i].hours[r]));e.OptionsForHoursByProjectMonthlyModal={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}}]),e.controller("monthlyEmployeeChartModalCtrl",["$scope","dataService","$uibModalInstance","index","report",function(e,o,t,r,n){for(e.index=r,e.year=n.year,e.name=n.items[r].employee,e.totalHours=n.items[r].total,e.CloseModal=function(){t.close()},e.dataForHoursForEmployeeByProjectMonthlyModal=[],e.labelsForHoursForEmployeeByProjectMonthlyModal=[],i=0;i<n.projects.length;i++)n.items[r].hours[i]>0&&(e.labelsForHoursForEmployeeByProjectMonthlyModal.push(n.projects[i].project),e.dataForHoursForEmployeeByProjectMonthlyModal.push(n.items[r].hours[i]));e.OptionsForHoursForEmployeeByProjectMonthlyModal={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}}])}(),function(){angular.module("timeKeeper").controller("personalReportController",["$scope","dataService","timeConfig",function(e,o,t){function r(t,r,n){var a="reports/personal/"+t;"undefined"!=r&&(a+="/"+r),"undefined"!=n&&(a+="/"+n),o.list(a,function(o){for(e.report=o,e.empId=o.employee.id,e.year=o.year,e.month=o.month-1,e.dataForMVSY=[],e.labelsForMVSY=["Total hours in this month","Total hours in this year"],e.dataForMVSY.push(o.totalHours),e.dataForMVSY.push(o.totalHoursInYear),e.OptionsForMVSY={legend:{display:!0,position:"top"}},e.dataForDayStatistic=[],e.labelsForDayStatistic=["Working days","Vacation days","Public holidays","Religious days","Business absences","Sick leave days","Other Absence"],e.dataForDayStatistic.push(o.workingDays),e.dataForDayStatistic.push(o.vacationDays),e.dataForDayStatistic.push(o.publicHolidays),e.dataForDayStatistic.push(o.religiousDays),e.dataForDayStatistic.push(o.businessAbsences),e.dataForDayStatistic.push(o.sickLeaveDays),e.dataForDayStatistic.push(o.otherAbsenceDays),e.OptionsForDayStatistic={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForHoursByProject=[],e.labelsForHoursByProject=[],i=0;i<o.projects.length;i++)e.labelsForHoursByProject.push(o.projects[i].name),e.dataForHoursByProject.push(o.projects[i].hours);e.OptionsForHoursByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilization=[],e.labelsForUtilization=["Total hours in this month","Total hours possible"],e.dataForUtilization.push(o.totalHours),e.dataForUtilization.push(o.totalPossibleHours),e.OptionsForUtilization={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}if(e.months=t.months,e.month=6,e.year=2017,e.showing=!1,e.empsShow=!0,e.people=[],e.empId=currentUser.id,"Administrator"==e.currentUser.role)e.empsShow=!0,o.list("employees/all",function(o){e.people=o}),e.listReport=function(){void 0===e.empId?(e.showing=!1,window.alert("You have to choose an employee")):(r(e.empId,e.year,e.month+1),e.showing=!0)},e.listReport();else if(e.currentUser.teams.length>0){var n=[];n.push(e.currentUser.id),o.list("members",function(t){for(e.members=t,i=0;i<e.members.length;i++)for(j=0;j<e.currentUser.teams.length;j++)e.members[i].team.id==currentUser.teams[j].id&&e.members[i].employee.id!=e.currentUser.id&&n.push(e.members[i].employee.id);for(j=0;j<n.length;j++)o.read("employees",n[j],function(o){e.people.push(o)})}),e.empsShow=!0,e.listReport=function(){void 0===e.empId?(e.showing=!1,window.alert("You have to choose an employee")):(r(e.empId,e.year,e.month+1),e.showing=!0)},e.listReport()}else e.empsShow=!1,e.listReport=function(){r(e.currentUser.id,e.year,e.month+1),e.showing=!0},e.listReport()}])}(),function(){var e=angular.module("timeKeeper");e.controller("profileController",["$scope","dataService","$uibModal","$location",function(e,o,t,r){currentUser.id==currentUser.profileId?o.read("employees",currentUser.id,function(o){e.person=o}):o.read("employees",currentUser.profileId,function(o){e.person=o,currentUser.profileId=currentUser.id}),e.edit=function(e){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){return e}}})},e.delete=function(e){swal({title:e.name,text:"Are you sure you want to delete this employee?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(o.delete("employees",e.id,function(e){window.alert("Employee deleted!"),r.path("/employees")}),swal.close())})}}]),e.controller("EmpModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,r){r.list("roles",function(e){o.roles=e}),o.person=t,o.oldPerson=angular.copy(t),o.save=function(t){t.image=o.person.image?o.person.image.base64:"",r.update("employees",t.id,t,function(e){window.alert("Employee successfully updated!"),currentUser.id==currentUser.profileId?r.read("employees",currentUser.id,function(e){o.person=e}):r.read("employees",currentUser.profileId,function(e){o.person=e,currentUser.profileId=currentUser.id})}),e.close()},o.cancel=function(t){angular.copy(o.oldPerson,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectController",["$scope","dataService","$location","$uibModal",function(e,o,t,r){"Administrator"!=e.currentUser.role||0==e.projectId?t.path("/calendar"):(console.log(e.projectId),o.read("projects",e.projectId,function(o){e.project=o})),e.edit=function(e){r.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.delete=function(e){swal({title:e.name,text:"Are you sure you want to delete this project?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(r){r&&(o.delete("projects",e.id,function(e){t.path("/projects")}),swal.close())})}}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","project","dataService",function(e,o,t,r){r.list("customers",function(e){o.customers=e}),r.list("teams",function(e){o.teams=e}),o.project=t,o.oldproject=angular.copy(t),o.save=function(t){void 0===t.id?r.insert("projects",t,function(o){window.alert("Project inserted!"),e.close()}):r.update("projects",t.id,t,function(t){o.$emit("projectsUpdated"),window.alert("Project updated!"),e.close()})},o.cancel=function(){angular.copy(o.oldproject,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectHistoryController",["$scope","dataService","$location","$uibModal",function(e,o,t,r){e.showing=!1,e.projId=1,"Administrator"!=e.currentUser.role?t.path("/calendar"):(o.list("projects",function(o){e.projects=o,e.listReport()}),e.listReport=function(){void 0==e.projId?(e.showing=!1,window.alert("Choose project!!")):o.list("reports/projectsHistory?projectId="+e.projId,function(o){for(e.report=o,e.showing=!0,e.projId=o.id,e.labelsForProjectHistory=[],e.dataForProjectHistory=[[],[],[]],i=0;i<12;i++)e.labelsForProjectHistory.push(o.total[0].monthlyHours[i].month),e.dataForProjectHistory[0].push(o.total[0].monthlyHours[i].hours),e.dataForProjectHistory[1].push(o.total[1].monthlyHours[i].hours),e.dataForProjectHistory[2].push(o.total[2].monthlyHours[i].hours);for(e.ProjectHistorySeries=["2016","2017","2018"],e.OptionsForProjectHistory={legend:{display:!0},scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}},console.log(o.total[0].totalHours),e.dataForTotalHoursByYears=[],e.labelsForTotalHoursByYears=["2016","2017","2018"],i=0;i<3;i++)e.dataForTotalHoursByYears.push(o.total[i].totalHours);e.OptionsForTotalHoursByYears={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.BuildChart=function(e,o){r.open({animation:!0,ariaLabelledBy:"ProjectHistoryEmployee-chart-modal-title",ariaDescribedBy:"ProjectHistoryEmployee-chart-modal-body",templateUrl:"views/modals/ProjectHistoryEmployeeChartModal.html",controller:"ChartEmployeeController",controllerAs:"$paaaaf",resolve:{index:function(){return e},data:function(){return o}}})}})})}]),e.controller("ChartEmployeeController",["$scope","dataService","$uibModalInstance","index","data",function(e,o,t,r,n){for(e.index=r,e.name=n.name,e.CloseModal=function(){t.close()},e.labelsForEmployeeProjectHistoryModal=[],e.dataForEmployeeProjectHistoryModal=[[],[],[]],i=0;i<12;i++)e.labelsForEmployeeProjectHistoryModal.push(n.sums[0].monthlyHours[i].month),e.dataForEmployeeProjectHistoryModal[0].push(n.sums[0].monthlyHours[i].hours),
e.dataForEmployeeProjectHistoryModal[1].push(n.sums[1].monthlyHours[i].hours),e.dataForEmployeeProjectHistoryModal[2].push(n.sums[2].monthlyHours[i].hours);e.ProjectHistoryEmployeeSeries=["2016","2017","2018"],e.OptionsForEmployeeProjectHistoryModal={legend:{display:!0},scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]}}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectsController",["$scope","$uibModal","dataService","$rootScope","$location",function(e,o,t,r,n){function a(){t.list("projects",function(o,t){e.projects=o})}"Administrator"!=e.currentUser.role?n.path("/calendar"):(a(),e.$on("projectsUpdated",function(e){a()})),e.add=function(){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModalAdd.html",controller:"projModalAdd",controllerAs:"$proj",resolve:{project:function(){}}})},e.view=function(e){console.log(e),n.path("/project"),r.projectId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this project?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(r){r&&(t.delete("projects",o.id,function(o){e.$emit("projectsUpdated")}),swal.close())})}}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","project","dataService",function(e,o,t,r){r.list("customers",function(e){o.customers=e}),r.list("teams",function(e){o.teams=e}),o.project=t,o.oldproject=angular.copy(t),o.save=function(t){r.update("projects",t.id,t,function(t){o.$emit("projectsUpdated"),window.alert("Project updated!"),e.close()})},o.cancel=function(){angular.copy(o.oldproject,t),e.dismiss()}}]),e.controller("projModalAdd",["$uibModalInstance","$scope","project","dataService",function(e,o,t,r){r.list("customers",function(e){o.customers=e}),r.list("teams",function(e){o.teams=e}),o.project=t,o.add=function(o){r.insert("projects",o,function(o){window.alert("Project inserted!"),e.close()})},o.cancel=function(){e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamController",["$scope","dataService","$location","$rootScope","$uibModal",function(e,o,t,r,n){function a(){o.read("teams",e.teamId,function(o){e.team=o})}"Administrator"!=e.currentUser.role||0==e.teamId?t.path("/calendar"):(a(),e.$on("membersUpdated",function(e){a()})),e.view=function(n){t.path("/profile"),r.currentUser.profileId=n.employee.id,o.read("employees",n.employee.id,function(o){e.person=o})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/tmModal.html",controller:"TmModalCtrl",controllerAs:"$tm",resolve:{team:function(){return e}}})},e.delete=function(t){swal({title:t.name,text:"Are you sure you want to delete this team?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(r){r&&(o.delete("teams",t.id,function(o){window.alert("Successfully deleted!"),e.$emit("teamsUpdated")}),swal.close())})},e.addMember=function(o){n.open({animation:!0,ariaLabelledBy:"tm-add-emp-modal-title",ariaDescribedBy:"tm-add-emp-modal-body",templateUrl:"views/modals/tmAddEmpModal.html",controller:"TmAddEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return o}}}).closed.then(function(){e.$emit("membersUpdated")})},e.editMember=function(e){n.open({animation:!0,ariaLabelledBy:"tm-emp-modal-title",ariaDescribedBy:"tm-emp-modal-body",templateUrl:"views/modals/tmEmpModal.html",controller:"TmEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return e}}})},e.deleteMember=function(t){swal({title:t.employee.name,text:"Are you sure you want to delete this employee from team "+t.team.name+"?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(r){r&&(o.delete("members",t.id,function(o){e.$emit("membersUpdated")}),swal.close())})}}]),e.controller("TmModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,r){o.team=t,o.oldteam=angular.copy(t),o.ok=function(t){r.update("teams",t.id,t,function(t){o.$emit("teamsUpdated"),e.close()})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}]),e.controller("TmEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,r){r.list("roles",function(e){o.roles=e}),o.member=t,o.oldMember=angular.copy(t),o.save=function(o){r.update("members",o.id,o,function(o){e.close()})},o.cancel=function(t){angular.copy(o.oldMember,t),e.dismiss()}}]),e.controller("TmAddEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,r){o.member=t,o.oldteam=angular.copy(t),r.list("employees/all",function(e){o.employees=e}),r.list("roles",function(e){o.roles=e}),o.add=function(o){var t={role:{id:o.role.id},team:{id:o.id},employee:{id:o.employee.id},hours:o.hours};console.log(t),r.insert("members",t,function(o){e.close()&&window.alert("Member added!")})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}])}(),function(){angular.module("timeKeeper").controller("teamDashboardController",["$scope","dataService","timeConfig","$location","$rootScope",function(e,o,t,r,n){function a(t,r,n){var a="reports/TeamReport?teamId="+t;"undefined"!=r&&(a+="&year="+r),"undefined"!=n&&(a+="&month="+n),o.list(a,function(o){for(e.report=o,e.teamId=o.id,e.year=o.year,e.month=o.month-1,e.dataForUtilizationForTeam=[],e.labelsForUtilizationForTeam=["Total hours in this month","Total hours possible"],e.dataForUtilizationForTeam.push(o.totalHours),e.dataForUtilizationForTeam.push(o.maxPossibleHours),e.OptionsForUtilizationForTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForMissingEntriesTeam=[],e.labelsForMissingEntriesTeam=[],i=0;i<o.reports.length;i++)e.labelsForMissingEntriesTeam.push(o.reports[i].employee.name),e.dataForMissingEntriesTeam.push(o.reports[i].days.missingEntries);for(e.OptionsForMissingEntriesTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForHoursByProjectTeam=[],e.labelsForHoursByProjectTeam=[],i=0;i<o.projects.length;i++)e.labelsForHoursByProjectTeam.push(o.projects[i].name),e.dataForHoursByProjectTeam.push(o.projects[i].hours);for(e.OptionsForHoursByProjectTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForOvertimeHoursTeam=[],e.labelsForOvertimeHoursTeam=[],i=0;i<o.reports.length;i++)e.labelsForOvertimeHoursTeam.push(o.reports[i].employee.name),e.dataForOvertimeHoursTeam.push(o.reports[i].days.overtimeHours);for(e.OptionsForOvertimeHoursTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationByMemberTeam=[],e.labelsForUtilizationByMemberTeam=[],i=0;i<o.reports.length;i++)e.labelsForUtilizationByMemberTeam.push(o.reports[i].employee.name),e.dataForUtilizationByMemberTeam.push(o.reports[i].days.percentageOfWorkingDays);for(e.OptionsForUtilizationByMemberTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,ticks:{suggestedMin:0,autoSkip:!1,beginAtZero:!0}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForPTOByMemberTeam=[],e.labelsForPTOByMemberTeam=[],i=0;i<o.reports.length;i++)e.labelsForPTOByMemberTeam.push(o.reports[i].employee.name),e.dataForPTOByMemberTeam.push(o.reports[i].pto);e.OptionsForPTOByMemberTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,ticks:{suggestedMin:0,autoSkip:!1,beginAtZero:!0}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}if(e.months=t.months,e.month=6,e.year=2017,e.showing=!1,e.teamsShow=!1,e.teams=[],new Object,"Administrator"==e.currentUser.role)e.teamsShow=!0,o.list("teams",function(o){e.teams=o});else if(e.currentUser.teams.length>0){e.teamsShow=!0;var s=[];for(i=0;i<e.currentUser.teams.length;i++)s.push(e.currentUser.teams[i].id);for(j=0;j<s.length;j++)o.read("teams",s[j],function(o){e.teams.push(o)})}else r.path("/calendar");e.listReport=function(){void 0==e.teamId&&(e.showing=!1,window.alert("Choose team!")),void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):(a(e.teamId,e.year,e.month+1),e.showing=!0)},"Administrator"==currentUser.role?(e.teamId="A",e.listReport()):currentUser.teams.length>0&&(e.teamId=currentUser.teams[0].id,e.listReport())}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamsController",["$scope","$uibModal","dataService","$location","$rootScope",function(e,o,t,r,n){function a(){t.list("teams",function(o,t){e.teams=o})}"Administrator"!=e.currentUser.role?r.path("/calendar"):(a(),e.$on("teamsUpdated",function(e){a()})),e.add=function(){o.open({animation:!0,ariaLabelledBy:"tm-new-modal-title",ariaDescribedBy:"tm-new-modal-body",templateUrl:"views/modals/tmNewTeamModal.html",controller:"TmNewTeamModalCtrl",controllerAs:"$tm",resolve:{team:function(){}}}).closed.then(function(){e.$emit("teamsUpdated")})},e.view=function(e){console.log(e),r.path("/team"),n.teamId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/tmModal.html",controller:"TmModalCtrl",controllerAs:"$tm",resolve:{team:function(){return e}}})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this team?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(r){r&&(t.delete("teams",o.id,function(o){window.alert("Successfully deleted!"),e.$emit("teamsUpdated")}),swal.close())})}}]),e.controller("TmNewTeamModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,r){o.team=t,o.add=function(t){r.insert("teams",t,function(){o.$emit("teamsUpdated"),window.alert("Team added!")}),e.close()},o.cancel=function(){e.dismiss()}}]),e.controller("TmModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,r){o.team=t,o.oldteam=angular.copy(t),o.save=function(t){r.update("teams",t.id,t,function(t){o.$emit("teamsUpdated"),e.close()})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("timeTrackingController",["$scope","$uibModal","dataService","timeConfig",function(e,o,t,r){function n(o,r,n){var a="calendar?id="+o;"undefined"!=r&&(a+="&year="+r),"undefined"!=n&&(a+="&month="+n),t.list(a,function(o){e.calendar=o,e.empId=o.employee.id,e.year=o.year,e.month=o.month-1,e.num=function(){var e=new Date(o.days[0].date).getDay()-1;return e<0&&(e=6),new Array(e)}})}if(e.empId=currentUser.id,e.dayType=r.dayType,e.months=r.months,e.month=3,e.year=2018,e.showEmployees=!1,e.people=[],e.missingEntries=[],"Administrator"==e.currentUser.role)e.showEmployees=!0,t.list("employees/all",function(o){e.people=o});else if(e.currentUser.teams.length>0){e.showEmployees=!0;var a=[];a.push(e.currentUser.id),t.list("members",function(o){for(e.members=o,i=0;i<e.members.length;i++)for(j=0;j<e.currentUser.teams.length;j++)e.members[i].team.id==currentUser.teams[j].id&&e.members[i].employee.id!=e.currentUser.id&&a.push(e.members[i].employee.id);for(j=0;j<a.length;j++)t.read("employees",a[j],function(o){e.people.push(o)})})}else e.empId=e.currentUser.id;e.buildCalendar=function(){void 0===e.empId?window.alert("You have to choose an employee"):n(e.empId,e.year,e.month+1)},e.buildCalendar(),e.$on("calendarUpdated",function(o){n(e.empId,e.year,e.month+1)}),e.edit=function(e){o.open({animation:!0,templateUrl:"views/modals/calendarModal.html",controller:"ModalCalendarCtrl",size:"lg",resolve:{day:function(){return e}}})}}]),e.controller("ModalCalendarCtrl",["$uibModalInstance","$scope","dataService","timeConfig","day",function(e,o,t,r,n){function a(){o.day.hours=0;for(var e=0;e<o.day.details.length;e++)o.day.details[e].deleted||(o.day.hours+=Number(o.day.details[e].hours))}function s(){o.newTask={id:0,description:"",hours:0,project:{id:0,name:""},deleted:!1}}o.day=n,o.dayType=r.dayDesc,o.projects=[],t.read("employees",n.employee.id,function(e){var t=e;for(i=0;i<t.projects.length;i++)o.projects.push(t.projects[i]);console.log(o.projects)}),s(),o.add=function(e){o.day.details.push(e),a(),s()},o.upd=function(e,o){a()},o.del=function(e){o.day.details[e].deleted=!0,a()},o.ok=function(){t.insert("calendar",o.day,function(e){o.$emit("calendarUpdated")}),a(),e.close()},o.cancel=function(){e.dismiss()},o.typeChanged=function(){1!=o.day.type&&(o.day.hours=8)}}])}(),function(){angular.module("timeKeeper").directive("employee",[function(){return{restrict:"E",scope:{people:"=employee"},controller:"empController as $emp",templateUrl:"views/widgets/employee-widget.html"}}])}(),function(){angular.module("timeKeeper").factory("dataService",["$rootScope","$http","timeConfig","infoService",function(e,o,t,r){function n(o){e.waitForLoad=o}var a=t.apiUrl;return{list:function(e,t){n(!0),o.get(a+e).then(function(e){return n(!1),t(e.data,e.headers)},function(o){n(!1),r.error(e,message)})},read:function(e,t,s){n(!0),o.get(a+e+"/"+t).then(function(e){return n(!1),s(e.data)},function(o){n(!1),r.error(e,message)})},insert:function(e,t,s){n(!0),o({method:"post",url:a+e,data:t}).then(function(o){return n(!1),r.success(e,"data successfully inserted"),s(o.data)},function(o){n(!1),r.error(e,message)})},update:function(e,t,s,i){n(!0),o({method:"put",url:a+e+"/"+t,data:s}).then(function(o){return n(!1),r.success(e,"data successfully updated"),i(o.data)},function(o){n(!1),r.error(e,message)})},delete:function(e,t,s){n(!0),o({method:"delete",url:a+e+"/"+t}).then(function(e){return n(!1),r.warning("are yA SURE?","data successfully deleted"),s(e.data)},function(o){n(!1),r.error(e,message)})},setLoader:function(o){e.waitForLoad=o}}}])}(),function(){angular.module("timeKeeper").factory("infoService",["toaster",function(e){return{info:function(o,t){e.pop("info",o,t,3e3)},success:function(o,t){e.pop("success",o,t,3e3)},warning:function(o,t){e.pop("warning",o,t,3e3)},error:function(e,o){swal({title:e,text:o,type:"error"})}}}])}();