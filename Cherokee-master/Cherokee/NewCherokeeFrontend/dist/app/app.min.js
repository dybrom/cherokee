!function(){var e=angular.module("timeKeeper",["ngRoute","ui.bootstrap","toaster","ngAnimate","naif.base64","chart.js"]);currentUser={id:0},projectId=0,teamId=0,customerId=0,e.constant("timeConfig",{apiUrl:"http://localhost:56111/api/",idsUrl:"http://localhost:53834/connect/token",dayType:["empty","workingday","publicholiday","otherabsence","religiousday","sickleave","vacation","businessabsence","weekend","future"],dayDesc:[" ","Working Day","Public Holiday","Other Absence","Religious Day","Sick Leave","Vacation","Business Absence"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]}),e.config(["$routeProvider",function(e){e.when("/teams",{templateUrl:"views/teams.html",controller:"teamsController",loginR:!0}).when("/team",{templateUrl:"views/team.html",controller:"teamController",loginR:!0}).when("/profile",{templateUrl:"views/profile.html",controller:"profileController",loginR:!0}).when("/employees",{templateUrl:"views/employees.html",controller:"employeesController",loginR:!0}).when("/customers",{templateUrl:"views/customers.html",controller:"customersController",loginR:!0}).when("/customer",{templateUrl:"views/customer.html",controller:"customerController",loginR:!0}).when("/projects",{templateUrl:"views/projects.html",controller:"projectsController",loginR:!0}).when("/project",{templateUrl:"views/project.html",controller:"projectController",loginR:!0}).when("/calendar",{templateUrl:"views/timeTracking.html",controller:"timeTrackingController",loginR:!0}).when("/login",{templateUrl:"views/login.html",controller:"loginController",loginR:!1}).when("/logout",{templateUrl:"views/login.html",controller:"logoutController",loginR:!1}).when("/personalreport",{templateUrl:"views/personalReport.html",controller:"personalReportController",loginR:!0}).when("/annualreport",{templateUrl:"views/annualReport.html",controller:"annualReportController",loginR:!0}).when("/monthlyreport",{templateUrl:"views/monthlyReport.html",controller:"monthlyReportController",loginR:!0}).when("/projecthistory",{templateUrl:"views/projectHistory.html",controller:"projectHistoryController",loginR:!0}).when("/teamdashboard",{templateUrl:"views/teamDashboard.html",controller:"teamDashboardController",loginR:!0}).when("/companydashboard",{templateUrl:"views/companyDashboard.html",controller:"companyDashboardController",loginR:!0}).when("/missingentries",{templateUrl:"views/missingEntries.html",controller:"missingEntriesController",loginR:!0}).when("/charttest",{templateUrl:"views/chartTest.html",controller:"chartTestController",loginR:!0}).otherwise({redirectTo:"/personalreport"})}]).run(["$rootScope","$location",function(e,o){e.$on("$routeChangeStart",function(e,t,n){0===currentUser.id&&t.$$route.loginR&&o.path("/login")})}])}();var dropdown=document.getElementsByClassName("dropdown-btn"),i;for(i=0;i<dropdown.length;i++)dropdown[i].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"});$(window,document,void 0).ready(function(){$("input").blur(function(){var e=$(this);e.val()?e.addClass("used"):e.removeClass("used")});var e=$(".ripples");e.on("click.Ripples",function(e){var o=$(this),t=o.parent().offset(),n=o.find(".ripplesCircle"),r=e.pageX-t.left,a=e.pageY-t.top;n.css({top:a+"px",left:r+"px"}),o.addClass("is-active")}),e.on("animationend webkitAnimationEnd mozAnimationEnd oanimationend MSAnimationEnd",function(e){$(this).removeClass("is-active")})}),function(){angular.module("timeKeeper").controller("annualReportController",["$scope","dataService","timeConfig","$location",function(e,o,t,n){function r(t){var n="reports/annual/";"undefined"!=t&&(n+=t),o.list(n,function(o){e.report=o,e.year=o.year})}"Administrator"!=e.currentUser.role?n.path("/calendar"):(e.months=t.months,e.showing=!1,e.listReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):(r(e.year),e.showing=!0)})}])}(),function(){angular.module("timeKeeper").controller("chartTestController",["$scope",function(e){e.message="wow",e.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],e.data=[300,500,100]}])}(),function(){angular.module("timeKeeper").controller("companyDashboardController",["$scope","dataService","timeConfig",function(e,o,t){e.months=t.months,e.month=6,e.year=2017,e.showing=!1,"Administrator"!=e.currentUser.role?$location.path("/calendar"):e.companyReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):o.list("reports/CompanyReport?year="+e.year+"&month="+e.month,function(o){for(e.report=o,e.showing=!0,e.year=o.year,e.month=o.month,console.log(e.report),e.dataForUtilizationForCompany=[],e.labelsForUtilizationForCompany=["Total hours in this month","Total hours possible"],e.dataForUtilizationForCompany.push(o.totalHours),e.dataForUtilizationForCompany.push(o.maxPossibleHours),e.OptionsForUtilizationForCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationForCompanyByRole=[],e.labelsForUtilizationForCompanyByRole=["Developer","QA Engineer","UI/UX","Project Manager"],e.dataForUtilizationForCompanyByRole.push(o.devUtilization),e.dataForUtilizationForCompanyByRole.push(o.qaUtilization),e.dataForUtilizationForCompanyByRole.push(o.uiuxUtilization),e.dataForUtilizationForCompanyByRole.push(o.pmUtilization),e.OptionsForUtilizationForCompanyByRole={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationForCompanyByTeam=[],e.labelsForUtilizationForCompanyByTeam=[],i=0;i<o.teams.length;i++)e.labelsForUtilizationForCompanyByTeam.push(o.teams[i].name),e.dataForUtilizationForCompanyByTeam.push(o.teams[i].utilization);for(e.OptionsForUtilizationForCompanyByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForMissingEntriesInCompany=[],e.labelsForMissingEntriesInCompany=[],i=0;i<o.teams.length;i++)e.labelsForMissingEntriesInCompany.push(o.teams[i].name),e.dataForMissingEntriesInCompany.push(o.teams[i].missingEntries);for(e.OptionsForMissingEntriesInCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForOvertimeHoursByTeam=[],e.labelsForOvertimeHoursByTeam=[],i=0;i<o.teams.length;i++)e.labelsForOvertimeHoursByTeam.push(o.teams[i].name),e.dataForOvertimeHoursByTeam.push(o.teams[i].overtimeHours);for(e.OptionsForOvertimeHoursByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForRevenueByProject=[],e.labelsForRevenueByProject=[],i=0;i<o.projects.length;i++)e.labelsForRevenueByProject.push(o.projects[i].name),e.dataForRevenueByProject.push(o.projects[i].revenue);for(e.OptionsForRevenueByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForTotalHoursByTeam=[],e.labelsForTotalHoursByTeam=[],i=0;i<o.teams.length;i++)e.labelsForTotalHoursByTeam.push(o.teams[i].name),e.dataForTotalHoursByTeam.push(o.teams[i].totalHours);e.OptionsForTotalHoursByTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.labelsForRolesInCompany=["Project Manager","Developer","QA Engineer","UI/UX Designer"],e.dataForRolesInCompany=[o.pmCount,o.devCount,o.qaCount,o.uiuxCount],e.OptionsForRolesInCompany={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}}])}(),function(){angular.module("timeKeeper").controller("customerController",["$scope","dataService","$location",function(e,o,t){"Administrator"!=e.currentUser.role||0==e.customerId?t.path("/calendar"):(console.log(e.customerId),o.read("customers",e.customerId,function(o){e.customer=o}))}])}(),function(){var e=angular.module("timeKeeper");e.controller("customersController",["$scope","dataService","$location",function(e,o,t){function n(){o.list("customers",function(o){e.customers=o})}"Administrator"!=e.currentUser.role?t.path("/calendar"):(n(),e.$on("customersUpdated",function(e){n()}))}]),e.controller("custController",["$scope","$uibModal","$location","$rootScope","dataService",function(e,o,t,n,r){e.view=function(e){console.log(e),t.path("/customer"),n.customerId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModal.html",controller:"custModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})},e.add=function(){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/custModalAdd.html",controller:"custModalCtrl",controllerAs:"$cust",resolve:{customer:function(){}}}).closed.then(function(){e.$emit("customersUpdated")})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this customer?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(r.delete("customers",o.id,function(o){e.$emit("customersUpdated")}),swal.close())})}}]),e.controller("custModalCtrl",["$uibModalInstance","$scope","customer","dataService",function(e,o,t,n){o.customer=t,o.oldcustomer=angular.copy(t),o.save=function(o){void 0===o.id?n.insert("customers",o,function(o){window.alert("Customer inserted!"),e.close()}):n.update("customers",o.id,o,function(o){window.alert("Customer updated!"),e.close()})},o.cancel=function(){angular.copy(o.oldcustomer,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("employeesController",["$scope","dataService","$location",function(e,o,t){"Administrator"!=e.currentUser.role&&t.path("/calendar"),e.$on("employeesUpdated",function(){o.list("employees",function(o){e.people=o})})}]),e.controller("empController",["$scope","$rootScope","$uibModal","dataService","$location",function(e,o,t,n,r){e.showPagination=!0,e.currentPage=0,n.list("employees",function(o,t){e.page=JSON.parse(t("pagination")),console.log(e.page),e.people=o,e.totalItems=e.page.TotalItems}),e.view=function(e){r.path("/profile"),o.currentUser.profileId=e.id},e.edit=function(o){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){return o}}}).closed.then(function(){e.$emit("employeesUpdated")})},e.filter=function(o){""!=o?n.list("employees?pageSize=50&filter="+o,function(o,t){e.people=o,e.showPagination=!1}):""==o&&n.list("employees",function(o,t){e.people=o,e.showPagination=!0})},e.add=function(){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empAddModal.html",controller:"EmpAddModalCtrl",controllerAs:"$emp",resolve:{person:function(){}}}).closed.then(function(){e.$emit("employeesUpdated")})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this employee?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(n.delete("employees",o.id,function(o){window.alert("Employee deleted!"),e.$emit("employeesUpdated")}),swal.close())})},e.pageChanged=function(){var o=e.currentPage-1;n.list("employees?page="+o,function(o,t){e.people=o}),console.log("Page changed to: "+e.currentPage)}}]),e.controller("EmpModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,n){n.list("roles",function(e){o.roles=e}),o.person=t,o.oldPerson=angular.copy(t),o.save=function(t){t.image=o.person.image?o.person.image.base64:"",n.update("employees",t.id,t,function(e){o.$emit("employeesUpdated"),window.alert("Employee successfully updated!")}),e.close()},o.cancel=function(t){angular.copy(o.oldPerson,t),e.dismiss()}}]),e.controller("EmpAddModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,n){n.list("roles",function(e){o.roles=e}),o.person=t,o.add=function(t){t.image=o.person.image?o.person.image.base64:"",n.insert("employees",t,function(){o.$emit("employeesUpdated"),window.alert("Employee successfully inserted!")}),e.close()},o.cancel=function(){e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("loginController",["$scope","$rootScope","$http","timeConfig","$location",function(e,o,t,n,r){function a(e){auth2.attachClickHandler(e,{},function(e){var a=e.getAuthResponse().id_token;t.defaults.headers.common.Authorization="Bearer "+a,t.defaults.headers.common.Provider="google",t({method:"post",url:n.apiUrl+"login"}).then(function(e){currentUser=e.data,o.currentUser=currentUser,console.log(currentUser),r.path("/calendar")},function(e){window.alert(e.message)})})}o.currentUser=currentUser,function(e){gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:"339048602285-q49ou6s75b74fhp2a4bv3csrjenlthlv.apps.googleusercontent.com"}),a(document.getElementById(e))})}("loginBtn"),e.login=function(){var a={grant_type:"password",username:e.user.name,password:e.user.pass,scope:"openid"},i={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic dGltZWtlZXBlcjokY2gwMGw="};t({method:"POST",url:n.idsUrl,headers:i,data:a,transformRequest:function(e){var o=[];for(var t in e)o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")}}).success(function(e,a,i,s){authToken=e.access_token,t.defaults.headers.common.Authorization="Bearer "+authToken,t.defaults.headers.common.Provider="iserver",t({method:"GET",url:n.apiUrl+"login"}).success(function(e,t,n,a){currentUser=e,currentUser.token=authToken,console.log(currentUser),o.currentUser=currentUser,r.path("/calendar")})}).error(function(e,o,t,n){console.log("ERROR: "+o)})}}]),e.controller("logoutController",["$rootScope","$location",function(e,o){currentUser={id:0,role:"",name:"",teams:[],provider:"",token:""},e.currentUser=currentUser,window.location.reload(),o.path("/calendar"),console.log(currentUser)}])}(),function(){angular.module("timeKeeper").controller("missingEntriesController",["$scope","dataService","timeConfig",function(e,o,t){"Administrator"!=e.currentUser.role&&$location.path("/calendar"),e.months=t.months,e.year=2017,e.month=6,o.list("missingentries?year="+e.year+"&month="+e.month,function(o){e.entriesreport=o,e.year=o.year,e.month=o.month}),e.listReport=function(){o.list("missingentries?year="+e.year+"&month="+e.month,function(o){e.entriesreport=o,e.year=o.year,e.month=o.month})},e.deleteEntry=function(o){e.entriesreport.employees.splice(o,1),console.log(e.entriesreport)},e.SendEmails=function(){o.insert("missingentries",e.entriesreport,function(e){console.log("uspjesno")})}}])}(),function(){angular.module("timeKeeper").controller("monthlyReportController",["$scope","dataService","timeConfig","$location",function(e,o,t,n){function r(t,n){var r="reports/monthly/";"undefined"!=t&&(r+=t),"undefined"!=n&&(r+="/"+n),o.list(r,function(o){e.report=o,e.year=o.year,e.month=o.month-1})}"Administrator"!=e.currentUser.role?n.path("/calendar"):(e.months=t.months,e.showing=!1,e.listReport=function(){void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):(r(e.year,e.month),e.showing=!0)})}])}(),function(){angular.module("timeKeeper").controller("personalReportController",["$scope","dataService","timeConfig",function(e,o,t){function n(t,n,r){var a="reports/personal/"+t;"undefined"!=n&&(a+="/"+n),"undefined"!=r&&(a+="/"+r),o.list(a,function(o){for(e.report=o,e.empId=o.employee.id,e.year=o.year,e.month=o.month-1,e.dataForMVSY=[],e.labelsForMVSY=["Total hours in this month","Total hours in this year"],e.dataForMVSY.push(o.totalHours),e.dataForMVSY.push(o.totalHoursInYear),e.OptionsForMVSY={legend:{display:!0,position:"top"}},e.dataForDayStatistic=[],e.labelsForDayStatistic=["Working days","Vacation days","Public holidays","Religious days","Business absences","Sick leave days","Other Absence"],e.dataForDayStatistic.push(o.workingDays),e.dataForDayStatistic.push(o.vacationDays),e.dataForDayStatistic.push(o.publicHolidays),e.dataForDayStatistic.push(o.religiousDays),e.dataForDayStatistic.push(o.businessAbsences),e.dataForDayStatistic.push(o.sickLeaveDays),e.dataForDayStatistic.push(o.otherAbsenceDays),e.OptionsForDayStatistic={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForHoursByProject=[],e.labelsForHoursByProject=[],i=0;i<o.projects.length;i++)e.labelsForHoursByProject.push(o.projects[i].name),e.dataForHoursByProject.push(o.projects[i].hours);e.OptionsForHoursByProject={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilization=[],e.labelsForUtilization=["Total hours in this month","Total hours possible"],e.dataForUtilization.push(o.totalHours),e.dataForUtilization.push(o.totalPossibleHours),e.OptionsForUtilization={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}if(e.months=t.months,e.month=6,e.year=2017,e.showing=!1,e.empsShow=!0,e.people=[],"Administrator"==e.currentUser.role)e.empsShow=!0,o.list("employees/all",function(o){e.people=o}),e.listReport=function(){void 0===e.empId?(e.showing=!1,window.alert("You have to choose an employee")):(n(e.empId,e.year,e.month+1),e.showing=!0)};else if(e.currentUser.teams.length>0){var r=[];r.push(e.currentUser.id),o.list("members",function(t){for(e.members=t,i=0;i<e.members.length;i++)for(j=0;j<e.currentUser.teams.length;j++)e.members[i].team.id==currentUser.teams[j].id&&e.members[i].employee.id!=e.currentUser.id&&r.push(e.members[i].employee.id);for(j=0;j<r.length;j++)o.read("employees",r[j],function(o){e.people.push(o)})}),e.empsShow=!0,e.listReport=function(){void 0===e.empId?(e.showing=!1,window.alert("You have to choose an employee")):(n(e.empId,e.year,e.month+1),e.showing=!0)}}else e.empsShow=!1,e.listReport=function(){n(e.currentUser.id,e.year,e.month+1),e.showing=!0}}])}(),function(){var e=angular.module("timeKeeper");e.controller("profileController",["$scope","dataService","$uibModal","$location",function(e,o,t,n){currentUser.id==currentUser.profileId?o.read("employees",currentUser.id,function(o){e.person=o}):o.read("employees",currentUser.profileId,function(o){e.person=o,currentUser.profileId=currentUser.id}),e.edit=function(e){t.open({animation:!0,ariaLabelledBy:"emp-modal-title",ariaDescribedBy:"emp-modal-body",templateUrl:"views/modals/empModal.html",controller:"EmpModalCtrl",controllerAs:"$emp",resolve:{person:function(){return e}}})},e.delete=function(e){swal({title:e.name,text:"Are you sure you want to delete this employee?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(t){t&&(o.delete("employees",e.id,function(e){window.alert("Employee deleted!"),n.path("/employees")}),swal.close())})}}]),e.controller("EmpModalCtrl",["$uibModalInstance","$scope","person","dataService",function(e,o,t,n){n.list("roles",function(e){o.roles=e}),o.person=t,o.oldPerson=angular.copy(t),o.save=function(t){void 0==t.id?(t.image=o.person.image?o.person.image.base64:"",n.insert("employees",t,function(){window.alert("Employee successfully inserted!")})):(t.image=o.person.image?o.person.image.base64:"",n.update("employees",t.id,t,function(e){window.alert("Employee successfully updated!")})),e.close()},o.cancel=function(t){angular.copy(o.oldPerson,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectController",["$scope","dataService","$location","$uibModal",function(e,o,t,n){"Administrator"!=e.currentUser.role||0==e.projectId?t.path("/calendar"):(console.log(e.projectId),o.read("projects",e.projectId,function(o){e.project=o})),e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.delete=function(e){swal({title:e.name,text:"Are you sure you want to delete this project?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(o.delete("projects",e.id,function(e){t.path("/projects")}),swal.close())})}}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","project","dataService",function(e,o,t,n){n.list("customers",function(e){o.customers=e}),n.list("teams",function(e){o.teams=e}),o.project=t,o.oldproject=angular.copy(t),o.save=function(t){void 0===t.id?n.insert("projects",t,function(o){window.alert("Project inserted!"),e.close()}):n.update("projects",t.id,t,function(t){o.$emit("projectsUpdated"),window.alert("Project updated!"),e.close()})},o.cancel=function(){angular.copy(o.oldproject,t),e.dismiss()}}])}(),function(){angular.module("timeKeeper").controller("projectHistoryController",["$scope","dataService","$location",function(e,o,t){e.showing=!1,"Administrator"!=e.currentUser.role?t.path("/calendar"):(o.list("projects",function(o){e.projects=o}),e.listReport=function(){void 0==e.projId?(e.showing=!1,window.alert("Choose project!!")):o.list("reports/projectsHistory?projectId="+e.projId,function(o){e.report=o,e.showing=!0,e.projId=o.id})})}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectsController",["$scope","dataService","$location",function(e,o,t){function n(){o.list("projects",function(o,t){e.projects=o})}"Administrator"!=e.currentUser.role?t.path("/calendar"):(n(),e.$on("projectsUpdated",function(e){n()}))}]),e.controller("projController",["$scope","$uibModal","dataService","$rootScope","$location",function(e,o,t,n,r){e.add=function(){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModalAdd.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){}}}).closed.then(function(){e.$emit("projectsUpdated")})},e.view=function(e){console.log(e),r.path("/project"),n.projectId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/modals/projModal.html",controller:"ModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this project?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(t.delete("projects",o.id,function(o){e.$emit("projectsUpdated")}),swal.close())})}}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","project","dataService",function(e,o,t,n){n.list("customers",function(e){o.customers=e}),n.list("teams",function(e){o.teams=e}),o.project=t,o.oldproject=angular.copy(t),o.save=function(t){void 0===t.id?n.insert("projects",t,function(o){window.alert("Project inserted!"),e.close()}):n.update("projects",t.id,t,function(t){o.$emit("projectsUpdated"),window.alert("Project updated!"),e.close()})},o.cancel=function(){angular.copy(o.oldproject,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamController",["$scope","dataService","$location","$rootScope","$uibModal",function(e,o,t,n,r){function a(){o.read("teams",e.teamId,function(o){e.team=o})}"Administrator"!=e.currentUser.role||0==e.teamId?t.path("/calendar"):(a(),e.$on("membersUpdated",function(e){a()})),e.view=function(r){t.path("/profile"),n.currentUser.profileId=r.employee.id,o.read("employees",r.employee.id,function(o){e.person=o})},e.edit=function(e){r.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/tmModal.html",controller:"TmModalCtrl",controllerAs:"$tm",resolve:{team:function(){return e}}})},e.delete=function(t){swal({title:t.name,text:"Are you sure you want to delete this team?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(o.delete("teams",t.id,function(o){window.alert("Successfully deleted!"),e.$emit("teamsUpdated")}),swal.close())})},e.addMember=function(o){r.open({animation:!0,ariaLabelledBy:"tm-add-emp-modal-title",ariaDescribedBy:"tm-add-emp-modal-body",templateUrl:"views/modals/tmAddEmpModal.html",controller:"TmAddEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return o}}}).closed.then(function(){e.$emit("membersUpdated")})},e.editMember=function(e){r.open({animation:!0,ariaLabelledBy:"tm-emp-modal-title",ariaDescribedBy:"tm-emp-modal-body",templateUrl:"views/modals/tmEmpModal.html",controller:"TmEmpModalCtrl",controllerAs:"$tm",resolve:{member:function(){return e}}})},e.deleteMember=function(t){swal({title:t.employee.name,text:"Are you sure you want to delete this employee from team "+t.team.name+"?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(o.delete("members",t.id,function(o){e.$emit("membersUpdated")}),swal.close())})}}]),e.controller("TmModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,n){o.team=t,o.oldteam=angular.copy(t),o.ok=function(t){n.update("teams",t.id,t,function(t){o.$emit("teamsUpdated"),e.close()})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}]),e.controller("TmEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,n){n.list("roles",function(e){o.roles=e}),o.member=t,o.oldMember=angular.copy(t),o.save=function(o){n.update("members",o.id,o,function(o){e.close()})},o.cancel=function(t){angular.copy(o.oldMember,t),e.dismiss()}}]),e.controller("TmAddEmpModalCtrl",["$uibModalInstance","$scope","member","dataService",function(e,o,t,n){o.member=t,o.oldteam=angular.copy(t),n.list("employees/all",function(e){o.employees=e}),n.list("roles",function(e){o.roles=e}),o.add=function(o){var t={role:{id:o.role.id},team:{id:o.id},employee:{id:o.employee.id},hours:o.hours};console.log(t),n.insert("members",t,function(o){e.close()&&window.alert("Member added!")})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}])}(),function(){angular.module("timeKeeper").controller("teamDashboardController",["$scope","dataService","timeConfig","$location",function(e,o,t,n){function r(t,n,r){var a="reports/TeamReport?teamId="+t;"undefined"!=n&&(a+="&year="+n),"undefined"!=r&&(a+="&month="+r),o.list(a,function(o){for(e.report=o,e.teamId=o.id,e.year=o.year,e.month=o.month,console.log(e.report.reports),e.dataForUtilizationForTeam=[],e.labelsForUtilizationForTeam=["Total hours in this month","Total hours possible"],e.dataForUtilizationForTeam.push(o.totalHours),e.dataForUtilizationForTeam.push(o.maxPossibleHours),e.OptionsForUtilizationForTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForMissingEntriesTeam=[],e.labelsForMissingEntriesTeam=[],i=0;i<o.reports.length;i++)e.labelsForMissingEntriesTeam.push(o.reports[i].employee.name),e.dataForMissingEntriesTeam.push(o.reports[i].days.missingEntries);for(e.OptionsForMissingEntriesTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForHoursByProjectTeam=[],e.labelsForHoursByProjectTeam=[],i=0;i<o.projects.length;i++)e.labelsForHoursByProjectTeam.push(o.projects[i].name),e.dataForHoursByProjectTeam.push(o.projects[i].hours);for(e.OptionsForHoursByProjectTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,stepSize:1,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForOvertimeHoursTeam=[],e.labelsForOvertimeHoursTeam=[],i=0;i<o.reports.length;i++)e.labelsForOvertimeHoursTeam.push(o.reports[i].employee.name),e.dataForOvertimeHoursTeam.push(o.reports[i].days.overtimeHours);for(e.OptionsForOvertimeHoursTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,beginAtZero:!0,ticks:{min:0,autoSkip:!1}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}},e.dataForUtilizationByMemberTeam=[],e.labelsForUtilizationByMemberTeam=[],i=0;i<o.reports.length;i++)e.labelsForUtilizationByMemberTeam.push(o.reports[i].employee.name),e.dataForUtilizationByMemberTeam.push(o.reports[i].days.percentageOfWorkingDays);e.OptionsForUtilizationByMemberTeam={scaleShowValues:!0,scales:{xAxes:[{stacked:!1,ticks:{suggestedMin:0,autoSkip:!1,beginAtZero:!0}}],yAxes:[{display:!0,ticks:{suggestedMin:0,beginAtZero:!0}}]}}})}if(e.months=t.months,e.month=6,e.year=2017,e.showing=!1,e.teamsShow=!1,e.teams=[],new Object,"Administrator"==e.currentUser.role)e.teamsShow=!0,o.list("teams",function(o){e.teams=o});else if(e.currentUser.teams.length>0){e.teamsShow=!0;var a=[];for(i=0;i<e.currentUser.teams.length;i++)a.push(e.currentUser.teams[i].id);for(j=0;j<a.length;j++)o.read("teams",a[j],function(o){e.teams.push(o)})}else n.path("/calendar");e.listReport=function(){void 0==e.teamId&&(e.showing=!1,window.alert("Choose team!")),void 0==e.year?(e.showing=!1,window.alert("Choose year!")):void 0==e.month?(e.showing=!1,window.alert("Choose month!")):(r(e.teamId,e.year,e.month),e.showing=!0)}}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamsController",["$scope","$uibModal","dataService","$location",function(e,o,t,n){"Administrator"!=e.currentUser.role?n.path("/calendar"):t.list("teams",function(o){e.teams=o});e.$on("teamsUpdated",function(o){t.list("teams",function(o){e.teams=o})}),e.add=function(){o.open({animation:!0,ariaLabelledBy:"tm-new-modal-title",ariaDescribedBy:"tm-new-modal-body",templateUrl:"views/modals/tmNewTeamModal.html",controller:"TmNewTeamModalCtrl",controllerAs:"$tm",resolve:{team:function(){}}}).closed.then(function(){e.$emit("teamsUpdated")})}}]),e.controller("TmNewTeamModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,n){o.team=t,o.add=function(t){n.insert("teams",t,function(){o.$emit("teamsUpdated"),e.close()&&window.alert("Team added!")})},o.cancel=function(){e.dismiss()}}]),e.controller("tmController",["$scope","$uibModal","dataService","$location","$rootScope",function(e,o,t,n,r){e.view=function(e){console.log(e),n.path("/team"),r.teamId=e.id},e.edit=function(e){o.open({animation:!0,ariaLabelledBy:"tm-modal-title",ariaDescribedBy:"tm-modal-body",templateUrl:"views/modals/tmModal.html",controller:"TmModalCtrl",controllerAs:"$tm",resolve:{team:function(){return e}}})},e.delete=function(o){swal({title:o.name,text:"Are you sure you want to delete this team?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonText:"Yes, sure",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(t.delete("teams",o.id,function(o){window.alert("Successfully deleted!"),e.$emit("teamsUpdated")}),swal.close())})}}]),
e.controller("TmModalCtrl",["$uibModalInstance","$scope","team","dataService",function(e,o,t,n){o.team=t,o.oldteam=angular.copy(t),o.save=function(t){n.update("teams",t.id,t,function(t){o.$emit("teamsUpdated"),e.close()})},o.cancel=function(t){angular.copy(o.oldteam,t),e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("timeTrackingController",["$scope","$uibModal","dataService","timeConfig",function(e,o,t,n){function r(o,n,r){var a="calendar?id="+o;"undefined"!=n&&(a+="&year="+n),"undefined"!=r&&(a+="&month="+r),t.list(a,function(o){e.calendar=o,e.empId=o.employee.id,e.year=o.year,e.month=o.month-1,e.num=function(){var e=new Date(o.days[0].date).getDay()-1;return e<0&&(e=6),new Array(e)}})}if(e.empId=1,e.dayType=n.dayType,e.months=n.months,e.month=6,e.year=2017,e.showEmployees=!1,e.people=[],e.missingEntries=[],"Administrator"==e.currentUser.role)e.showEmployees=!0,t.list("employees/all",function(o){e.people=o});else if(e.currentUser.teams.length>0){e.showEmployees=!0;var a=[];a.push(e.currentUser.id),t.list("members",function(o){for(e.members=o,i=0;i<e.members.length;i++)for(j=0;j<e.currentUser.teams.length;j++)e.members[i].team.id==currentUser.teams[j].id&&e.members[i].employee.id!=e.currentUser.id&&a.push(e.members[i].employee.id);for(j=0;j<a.length;j++)t.read("employees",a[j],function(o){e.people.push(o)})})}else e.empId=e.currentUser.id;e.buildCalendar=function(){void 0===e.empId?window.alert("You have to choose an employee"):r(e.empId,e.year,e.month+1)},e.$on("calendarUpdated",function(o){r(e.empId,e.year,e.month+1)}),e.edit=function(e){o.open({animation:!0,templateUrl:"views/modals/calendarModal.html",controller:"ModalCalendarCtrl",size:"lg",resolve:{day:function(){return e}}})}}]),e.controller("ModalCalendarCtrl",["$uibModalInstance","$scope","dataService","timeConfig","day",function(e,o,t,n,r){function a(){o.day.hours=0;for(var e=0;e<o.day.details.length;e++)o.day.details[e].deleted||(o.day.hours+=Number(o.day.details[e].hours))}function s(){o.newTask={id:0,description:"",hours:0,project:{id:0,name:""},deleted:!1}}o.day=r,o.dayType=n.dayDesc,o.projects=[],t.read("employees",r.employee.id,function(e){var t=e;for(i=0;i<t.projects.length;i++)o.projects.push(t.projects[i]);console.log(o.projects)}),s(),o.add=function(e){o.day.details.push(e),a(),s()},o.upd=function(e,o){a()},o.del=function(e){o.day.details[e].deleted=!0,a()},o.ok=function(){t.insert("calendar",o.day,function(e){o.$emit("calendarUpdated")}),a(),e.close()},o.cancel=function(){e.dismiss()},o.typeChanged=function(){1!=o.day.type&&(o.day.hours=8)}}])}(),function(){angular.module("timeKeeper").directive("employee",[function(){return{restrict:"E",scope:{people:"=employee"},controller:"empController as $emp",templateUrl:"views/widgets/employee-widget.html"}}])}(),function(){angular.module("timeKeeper").factory("dataService",["$rootScope","$http","timeConfig","infoService",function(e,o,t,n){function r(o){e.waitForLoad=o}var a=t.apiUrl;return{list:function(e,t){r(!0),o.get(a+e).then(function(e){return r(!1),t(e.data,e.headers)},function(o){r(!1),n.error(e,message)})},read:function(e,t,i){r(!0),o.get(a+e+"/"+t).then(function(e){return r(!1),i(e.data)},function(o){r(!1),n.error(e,message)})},insert:function(e,t,i){r(!0),o({method:"post",url:a+e,data:t}).then(function(o){return r(!1),n.success(e,"data successfully inserted"),i(o.data)},function(o){r(!1),n.error(e,message)})},update:function(e,t,i,s){r(!0),o({method:"put",url:a+e+"/"+t,data:i}).then(function(o){return r(!1),n.success(e,"data successfully updated"),s(o.data)},function(o){r(!1),n.error(e,message)})},delete:function(e,t,i){r(!0),o({method:"delete",url:a+e+"/"+t}).then(function(e){return r(!1),n.warning("are yA SURE?","data successfully deleted"),i(e.data)},function(o){r(!1),n.error(e,message)})}}}])}(),function(){angular.module("timeKeeper").factory("infoService",["toaster",function(e){return{info:function(o,t){e.pop("info",o,t,3e3)},success:function(o,t){e.pop("success",o,t,3e3)},warning:function(o,t){e.pop("warning",o,t,3e3)},error:function(e,o){swal({title:e,text:o,type:"error"})}}}])}();